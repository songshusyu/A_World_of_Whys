<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APIä¿®å¤æµ‹è¯•</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">ğŸ”§ API JSONæ ¼å¼ä¿®å¤æµ‹è¯•</h1>
        
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>ğŸŒŸ æµ‹è¯•æ§åˆ¶é¢æ¿</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">æµ‹è¯•é—®é¢˜ï¼š</label>
                            <input type="text" id="testQuestion" class="form-control" value="ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ">
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button class="btn btn-primary" onclick="testApiStatus()">ğŸ” æµ‹è¯•APIçŠ¶æ€</button>
                            <button class="btn btn-success" onclick="testAskQuestion()">ğŸ’¬ æµ‹è¯•é—®ç­”åŠŸèƒ½</button>
                            <button class="btn btn-info" onclick="testQwenConnection()">ğŸ”— æµ‹è¯•è¿æ¥</button>
                            <button class="btn btn-warning" onclick="clearResults()">ğŸ§¹ æ¸…ç©ºç»“æœ</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>ğŸ“Š æµ‹è¯•ç»“æœ</h5>
                    </div>
                    <div class="card-body">
                        <div id="testResults" class="bg-light p-3" style="height: 400px; overflow-y: auto;">
                            <p class="text-muted">ç‚¹å‡»å·¦ä¾§æŒ‰é’®å¼€å§‹æµ‹è¯•...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col-12">
                <div class="alert alert-info">
                    <h6>ğŸ¯ æµ‹è¯•ç›®æ ‡ï¼š</h6>
                    <ul>
                        <li>âœ… éªŒè¯åç«¯APIè¿”å›æ­£ç¡®çš„JSONæ ¼å¼</li>
                        <li>âœ… ç¡®è®¤å‰ç«¯èƒ½æ­£ç¡®è§£æJSONå“åº”</li>
                        <li>âœ… æµ‹è¯•CORSè·¨åŸŸé—®é¢˜æ˜¯å¦è§£å†³</li>
                        <li>âœ… éªŒè¯é€šä¹‰åƒé—®APIé›†æˆæ­£å¸¸å·¥ä½œ</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script>
        function logResult(title, data, isError = false) {
            const results = document.getElementById('testResults');
            const timestamp = new Date().toLocaleTimeString();
            const alertClass = isError ? 'alert-danger' : 'alert-success';
            
            results.innerHTML += `
                <div class="alert ${alertClass} alert-sm mb-2">
                    <strong>[${timestamp}] ${title}:</strong><br>
                    <small><pre>${JSON.stringify(data, null, 2)}</pre></small>
                </div>
            `;
            results.scrollTop = results.scrollHeight;
        }

        async function testApiStatus() {
            try {
                logResult('ğŸ“¡ æµ‹è¯•APIçŠ¶æ€', 'æ­£åœ¨è¯·æ±‚...', false);
                const result = await apiService.checkApiStatus();
                logResult('APIçŠ¶æ€æµ‹è¯•ç»“æœ', result, !result.success);
            } catch (error) {
                logResult('APIçŠ¶æ€æµ‹è¯•é”™è¯¯', { error: error.message }, true);
            }
        }

        async function testAskQuestion() {
            try {
                const question = document.getElementById('testQuestion').value;
                logResult('ğŸ¤” æµ‹è¯•é—®ç­”åŠŸèƒ½', `é—®é¢˜: "${question}"`, false);
                const result = await apiService.askQuestion(question);
                logResult('é—®ç­”æµ‹è¯•ç»“æœ', result, !result.success);
            } catch (error) {
                logResult('é—®ç­”æµ‹è¯•é”™è¯¯', { error: error.message }, true);
            }
        }

        async function testQwenConnection() {
            try {
                logResult('ğŸ”— æµ‹è¯•é€šä¹‰åƒé—®è¿æ¥', 'æ­£åœ¨æµ‹è¯•...', false);
                const result = await apiService.testQwenConnection();
                logResult('è¿æ¥æµ‹è¯•ç»“æœ', result, !result.success);
            } catch (error) {
                logResult('è¿æ¥æµ‹è¯•é”™è¯¯', { error: error.message }, true);
            }
        }

        function clearResults() {
            document.getElementById('testResults').innerHTML = 
                '<p class="text-muted">æµ‹è¯•ç»“æœå·²æ¸…ç©ºï¼Œç‚¹å‡»æŒ‰é’®å¼€å§‹æ–°çš„æµ‹è¯•...</p>';
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æµ‹è¯•APIçŠ¶æ€
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                logResult('ğŸš€ é¡µé¢åŠ è½½å®Œæˆ', 'å¼€å§‹è‡ªåŠ¨æµ‹è¯•APIçŠ¶æ€...', false);
                testApiStatus();
            }, 1000);
        });
    </script>
</body>
</html> 